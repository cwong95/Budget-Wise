<main class="page-content transaction-page">
  <section class="header-section">
    <h1>Manage Your Transactions</h1>
    <p>Add, review, and maintain your income and expenses.</p>
  </section>

  {{#if error}}
    <div class="error-banner">⚠️ {{error}}</div>
  {{/if}}

  <section class="transaction-form">
    <h2>Add a Transaction</h2>

    <form action="/transactions" method="POST" class="transactions-form">
      <div id="transactions-form-message" class="form-message" aria-live="polite"></div>

      <div class="form-group">
        <label for="title">Title</label>
        <input id="title" type="text" name="title" required>
      </div>

      <div class="form-group">
        <label for="amount">Amount ($)</label>
        <input id="amount" type="number" step="0.01" name="amount" required>
      </div>

      <div class="form-group">
        <label for="category">Category</label>
        <select id="category" name="category" required>
          <option value="">Select category</option>
          <option value="Food">Food</option>
          <option value="Housing">Housing</option>
          <option value="Travel">Travel</option>
          <option value="Utilities">Utilities</option>
          <option value="Entertainment">Entertainment</option>
          <option value="Other">Other</option>
        </select>
      </div>

      <div class="form-group">
        <label for="type">Type</label>
        <select id="type" name="type" required>
          <option value="Expense">Expense</option>
          <option value="Income">Income</option>
        </select>
      </div>

      <div class="form-group">
        <label for="date">Date</label>
        <input id="date" type="date" name="date" required>
      </div>

      <div class="form-group">
        <label for="notes">Notes</label>
        <textarea id="notes" name="notes"></textarea>
      </div>

      <button type="submit" class="btn btn-success">Add Transaction</button>
    </form>
  </section>

  <hr>

  <h2>All Transactions</h2>

  {{#if transactions.length}}
    <section class="current-utilities-list">
      {{#each transactions}}
        <div class="utility-card">
          <h3>{{this.title}}</h3>

          <div class="utility-meta">
            <span><strong>Amount:</strong> ${{this.amount}}</span>
            <span><strong>Category:</strong> {{this.category}}</span>
            <span><strong>Type:</strong> {{this.type}}</span>
            <span><strong>Date:</strong> {{this.dateFormatted}}</span>
            <span><strong>Notes:</strong> {{#if this.notes}}{{this.notes}}{{else}}—{{/if}}</span>
            <span><strong>Budget:</strong>
              {{#if this.budget}}
                <a href="/budgets">{{this.budget.category}}</a>
              {{else}}
                —
              {{/if}}
            </span>
          </div>

          <div class="utility-actions">
            <a href="/transactions/edit/{{this._id}}" class="btn btn-primary">Edit</a>

            <form action="/transactions/delete/{{this._id}}" method="POST">
              <button class="btn btn-danger" type="submit" data-confirm="Delete {{this.title}}?">Delete</button>
            </form>
          </div>
        </div>
      {{/each}}
    </section>
  {{else}}
    <p id="no-transactions-placeholder">No transactions found.</p>
  {{/if}}
</main>
<script src="/js/transactions-form.js"></script>
