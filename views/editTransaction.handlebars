<main class="page-content transaction-page">
    <section class="transaction-form">
        <h2>Edit Transaction</h2>

        {{#if error}}
            <div class="error-message">{{error}}</div>
        {{/if}}

        <form action="/transactions/edit/{{trans._id}}" method="POST" class="transactions-form">
            <div class="form-group">
                <label for="title">Title</label>
                <input class="form-control" id="title" type="text" name="title" value="{{trans.title}}" required>
            </div>

            <div class="form-group">
                <label for="amount">Amount</label>
                <input class="form-control" id="amount" type="number" step="0.01" name="amount" value="{{trans.amount}}" required>
            </div>

            <div class="form-group">
                <label for="category">Category</label>
                <select class="form-control" id="category" name="category" required>
                    <option value="">Select category</option>
                    <option value="Food">Food</option>
                    <option value="Housing">Housing</option>
                    <option value="Travel">Travel</option>
                    <option value="Utilities">Utilities</option>
                    <option value="Entertainment">Entertainment</option>
                    <option value="Other">Other</option>
                </select>
            </div>

            <div class="form-group">
                <label for="type">Type</label>
                <select class="form-control" id="type" name="type" required>
                    <option value="Expense">Expense</option>
                    <option value="Income">Income</option>
                </select>
            </div>

            <div class="form-group">
                <label for="date">Date</label>
                <input class="form-control" id="date" type="date" name="date" value="{{trans.date}}" required>
            </div>

            <div class="form-group">
                <label for="notes">Notes</label>
                <textarea class="form-control" id="notes" name="notes">{{trans.notes}}</textarea>
            </div>

            <div style="display:flex;gap:0.5rem;align-items:center;margin-top:0.6rem;">
                <button type="submit" class="btn primary-button">Save Changes</button>
                <a href="/transactions" class="btn" style="background:#eceff1;color:#333;border-radius:6px;padding:0.45rem 0.9rem;text-decoration:none;">Cancel</a>
            </div>
        </form>
    </section>

    <script>
        // Prefill select and normalize date input
        document.addEventListener('DOMContentLoaded', function () {
            try {
                var typeEl = document.getElementById('type');
                if (typeEl && '{{trans.type}}') {
                    typeEl.value = '{{trans.type}}';
                }

                    var categoryEl = document.getElementById('category');
                    if (categoryEl && '{{trans.category}}') {
                        categoryEl.value = '{{trans.category}}';
                    }

                var dateEl = document.getElementById('date');
                if (dateEl && '{{trans.date}}') {
                    var d = '{{trans.date}}';
                    if (d.indexOf('T') !== -1) d = d.split('T')[0];
                    dateEl.value = d;
                }
            } catch (e) { /* ignore */ }
        });
    </script>
</main>

